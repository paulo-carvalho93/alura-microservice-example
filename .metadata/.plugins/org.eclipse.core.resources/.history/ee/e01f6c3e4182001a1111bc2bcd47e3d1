package br.com.restaurante.pagamentoservice.service;

import org.springframework.messaging.support.MessageBuilder;
import org.springframework.stereotype.Service;

import br.com.restaurante.pagamentoservice.model.Pagamento;
import br.com.restaurante.pagamentoservice.model.PagamentoConfirmado;
import lombok.AllArgsConstructor;
import br.com.restaurante.pagamentoservice.AmqpPagamentoConfig.PagamentoSource;

@Service
@AllArgsConstructor
public class NotificacaoPagamentoConfirmado {
	
	 private PagamentoSource source;

	  public void notificaPagamentoConfirmado(Pagamento pagamento) {
	    Long pagamentoId = pagamento.getId();
	    Long pedidoId = pagamento.getPedidoId();
	    PagamentoConfirmado confirmado = new PagamentoConfirmado(pagamentoId, pedidoId);
	    source.pagamentosConfirmados().send(MessageBuilder.withPayload(confirmado).build());
	  }

}
